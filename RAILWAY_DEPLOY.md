# Инструкции по деплою на Railway

## Что такое Railway?
Railway - это платформа для деплоя приложений, которая автоматически обнаруживает тип вашего проекта и настраивает его для продакшена.

## Шаги для деплоя:

### 1. Подготовка
- Убедитесь, что ваш код загружен в GitHub репозиторий
- У вас есть API ключи для E2B и Firecrawl
- Опционально: API ключи для ИИ провайдеров (Anthropic, OpenAI, Gemini, Groq)

### 2. Создание проекта на Railway
1. Перейти на https://railway.app/
2. Зарегистрироваться/войти через GitHub
3. Нажать "New Project"
4. Выбрать "Deploy from GitHub repo"
5. Выбрать ваш репозиторий с Open Lovable

### 3. Настройка переменных окружения
В разделе "Variables" добавить следующие переменные:

**Обязательные:**
- `E2B_API_KEY` - ваш ключ от E2B (https://e2b.dev)
- `FIRECRAWL_API_KEY` - ваш ключ от Firecrawl (https://firecrawl.dev)

**ИИ провайдеры (нужен минимум один):**
- `ANTHROPIC_API_KEY` - ключ Anthropic
- `OPENAI_API_KEY` - ключ OpenAI  
- `GEMINI_API_KEY` - ключ Google Gemini
- `GROQ_API_KEY` - ключ Groq

**Системные (добавляются автоматически):**
- `NODE_ENV=production`
- `PORT` - устанавливается Railway автоматически

### 4. Деплой
Railway автоматически:
- Установит зависимости (`npm install`)
- Соберёт проект (`npm run build`) 
- Запустит сервер (`npm start`)

### 5. Получение URL
После успешного деплоя вы получите публичный URL для доступа к вашему приложению.

## Особенности настройки

### railway.json
Файл `railway.json` в корне проекта содержит конфигурацию для Railway:
- Использует Nixpacks builder
- Команда сборки: `npm install && npm run build`
- Команда запуска: `npm start`
- Политика перезапуска при ошибках

### nixpacks.toml
Файл `nixpacks.toml` настраивает процесс сборки:
- Использует Node.js 20 и npm
- Команда установки: `npm ci --no-optional`
- Команда сборки: `npm run build`

### Пакетный менеджер
Проект использует npm (не pnpm), поэтому убедитесь что:
- Есть файл `package-lock.json`
- Нет файла `pnpm-lock.yaml` в репозитории

### Переменные окружения
Railway автоматически подставляет переменные окружения из .env.local в продакшен.

### Логи
Логи доступны в интерфейсе Railway в разделе "Logs".

## Решение проблем

### Ошибки сборки
- Проверьте, что все зависимости указаны в package.json
- Убедитесь, что TypeScript код компилируется без ошибок

### Ошибки API ключей
- Проверьте правильность всех API ключей
- Убедитесь, что у ключей есть необходимые права доступа

### Проблемы с портом
Railway автоматически назначает порт через переменную PORT. Next.js это поддерживает по умолчанию.

## Обновления
Railway автоматически пересобирает и разворачивает приложение при каждом push в главную ветку GitHub репозитория.
